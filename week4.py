import sys
import pytest
import math

from lib import *
from util import *
import constants

import cProfile

def test_week4():
  print_sep("Randomized Motif Search")
  
  profiler = cProfile.Profile()
  profiler.enable()
  input=(['CTCTACTCTGACCGTCGTCAATTCTACTCCGGGCTCAACGGCTAGTCCCTACAAGTGTCACTCCAGCAGTGTTGATAGGGATTCCGATTGCCAAGCGGCGCGATGCACTCCCCTTCAATGAAGCTACTGGATTCCGTACCATCAGTTGTTATGGATGGTTATGTTTATTAAGTATACCCGGACCTCTACTCTGACCGT','CGTCAATTCTACTCCGGGCTCAACGGCTAGTCCCTACAAGTGTCACTCCAGAGACTATGTTTCCACCAGTGTTGATAGGGATTCCGATTGCCAAGCGGCGCGATGCACTCCCCTTCAATGAAGCTACTGGATTCCGTACCATCAGTTGTTATGGATGGTTATGTTTATTAAGTATACCCGGACCTCTACTCTGACCGT','TCGTCTCTAAGTTTCTCTGGCCAACTAGACCTGACGTACGAGGCTTAGCTCAAGTACAGTCGACAGACGTGCTCAGTTGGGCTGTGGCATTAATCAAATGGATCGTGTTTCCTAAAAACAAATGCATGGGGGGTCCATGAATACGATGTTATCTCATCGGGGGGCCTGGCGGGATATTACTACGCAGATTTGCGCTCA','AATTACACTCCACGCGGATTCTTAACACCTTGGCGTCGGACCGTGAGTCTACCATTATGGCGACGTTAGTGTGTGTATCGTGTTGTTCCTTCGATCTTGTGATTGTCCTGAGGATGCCTTAGGACGAGTTCAGGCCTATAGAGGAGATCGTGTAGGCACCGTTAAAACTGTTTCCTATCGTGGTCTTGTTCAGAAGCC','CGATCTTGAGATCTTACCGCAAGTTATGGTGAGGGAAGGCGAGGATCCCATTACGCCAGCACCAGGCAATGATGATACCAGACAATGCACATGGAATAGAGATCCAATTTCCACGAATACGAACTTGGCAATGTTATAGTAATCCTCAGTATAGCAATGATAATAGTATCGCGTCTGTAATCTAATTACAGATCAAGA','GATGTAGCGTGCCGTCTCTGCAACCTTGAATAGCATTCAGCGGGTACCATCGAAGTAGGCGTTACTTCAAGTGATCGAGACTTAAACAAACAAGCAGCAGATCGGTCTTCCACAAGCAGCTGCAGCATATTGTCTGGTCGCAAACTTTCCAACTATAGTTTTCGGGATTAGATAACTGCGATAAGCTTCAGGTGCTGT','TCGGCGGTCGCTATCAGGTCCACGTCTACTAGCTACTCTTTTGGTCGATGTGACAGCCGTCTGCAGACTATCATCGGTAGAGTGTTCGCGCCGATTACACCGTCGGCATCGCAGTACTGACGCAAGCTTATTTTGAGATTTGACACCGGCACCGGTAAGAAGGTTTTAAGTCTGTTGGAGATCGTGTTGGAACAAGAC','GCCAGCCATAAGATAATTAGACGATTCGTTACTTGGCATCGTGTTTCCATTGGGGACGCCAAAAAGGCAGAGGGGCTCCGCTCTCCCGGGTTGGTTGTATCTAAGAGAGTACTTAAAAAGCGCATGGGAAAGTCCAATCCCGATTGCACAAACCCTCAGCCTGTATCTATTGCAACCTGCAATCTTACAAGTGATAAC','AGCCTTGGCAGAAGTCTTCACTCACGAAACAGATCGTGACCCCACATGGCACCTTCAGCCCTGACGTGGCGGAACCGTTCTCAGAGACCTCAGATGCTAGCAGTCTCTTCCGTCAACCCTACTTTTTGATCCAATTTAGTGTCATGAGGAGCGGGGGCATTTAGTGCAGGTACTCCAATTATAGTGTTCAGCATGGGG','TCTAACGTCGAAAAGCGTCTCCCTAATTATTTCACCACGTGTTTCCACGACCAATGAGCACTCTATTACAATGACCCATTCCAATAATCTGCCCTCAGCGGACACGTGGGCGGGTCGGTCGTGACTCATCTTGCTGAAAGCTGTTCTTTACTTATGACTGTAGCGGCAGTCAGTTGGCCAGTCGGTGAGCAGATTACC','CGTCAGATGACGTTTCCACAGGTTCGAAAAGAGTCGAACCGGTAGATAAGCAGACTCGGCTTTCGACTCTTGGCGCTATAATCGGCGGTAAACGGAGAGAACAGGATCACACTATCAGCTATGTGGATGTCAACTTGAACTCACGGCTCGTTTACGGCTTAGTTAACCGAGCTATAAACATCTGGAATGTACAGCATG','ACTTGCGCTTGTTTCTACTTTGGGTTTACGCACACTATAAGGTCACAATGAACGCCGCCGCGGTGCTCGGGTCGTCCCGACTGAAGTCAAAACTATACTGACTAGTGTGAACGTTGCAGCTAGATCGTGTTTCGTATACATGAGACATCAAGGCGCCATTCTTCAATAAACTCGATAGCTCATAGGCCAGGCGGTATT','CATGTGCTCTCTTGGAAATTCCCTCCCGTGCGCGCAAGCAGGAGTGAGCAGTGGGTTCTCGATTCAGCAGGACAGTTGCTAGACTTAGTTACTACTTACGTGGTGGCTACCTACAGCTACGAAGACCTTGTGATTCGTGTCCATGGAGATCGTGTTTGGCCAGCCTAGCGTTGAAAACGATCTCTCCGGTACTGTTTT','GACATACTAAGTCGTTAAACCTTGTCTCACAATCAAGGTTCGTCTAGAAGCGGAAAAACTCTGGCAGTTAACTGAACGAATGATCAAAAGATTGGGACACCGTAAGAGCTGTATAAAAGATGACGTTTCCACACCAGGCGTTAGCCAATTCCCCCAAATCAGCTCGGAGGTGAATATGTTTGAGCGCTTTCCTAGACT','TTAACCGGAGGTACAACAAAACGTTCACAGCAATCGCTGAAAGTCTTTAACCAGCGAAGCCGGCGGGCTATCAGCTCCACTCTCGAAGTTAGTCACCTGTACACACAGAACGTCAATTCCTGAAGTCCAGCCGGCTACCAGGAGGAGTAATCCACTGGGGAAACGCAATATTCGTGTTTCCACAACCCACGGGTTTTA','GTGGGAGAAAACGCTCCTCGGTAATTTGTTTGCGCACAGGTCACGAAAGTGTCGCTCCTCTGGCACGGGTCCGAGCCAAGACCCGTGCTGCAACCTAGTCTTAGGTTCGTTGTAAAACTATGGAGTTTTATACAATGAGTCCCCATGCCGATAAGAAATTCAGATCCGATTTCCACAAATCCGTACGAAAAAGGATTC','TTTTCGTGGAAATACTCACTATTACGAAGGTGCAGTATTTATCTTCGCAATCTGATCGGAACCGTAGCAGAGTAGGAGTTACCTGTGCTGCATACGTCAACAGATAACTTTCCACGCGATCTACTCGAGTAGATCGAAATTCCACGAGCGGACCATAGCTCTACGACTGTCAGCGACGACCATACCAACGGCAGACTA','TTCTTAGGCGCGATGAGCATGTGTTTCCACGGTCAAATCTTTCCCTCGTCGAGCCGCCTCGACCAGGGATTCAAGTCGGTGCCTATTACGCCTCTTTGTACTTGAGGGGGCCAGCCGTTAGTGAGTTCTATTCTGTTGTGCAGTGTTATTCTCACCGTCGTTCATCCACCTGTGGCACAGCGCGCTCAGGACTCATAT','GTACCGTTTGTATGGTCTATCAGCGAGAGTTAAAAGCGGTAGCCATAGGGGCGAGGCGCGCAATCATGTCGCCGTTGTTACGCCTCTGTATATCGGTTCCGCGCGCCCAGCCTGAGGATAGAAATGTAACTGTTAGCCGATCGTCGGACTGTACTATGGCCAGAAGATGTTTCCACATGTAACTAAAAAAACCAAGTT','GATCGTCTAACTAGGGAGTTACCTGGCAATTACCCGACTCTACTACTTATGTTTCACAACTTCAACTGTTAAGTCCCTAATTCATAGATCGTAGGTCCACTTGTGGTGCTCAAATTCGACATTTCTAGCTCATATTTGCGGAAGCCGGTCGCGATCTCACTCAATTGGATTTTCAGGCTACGGCGCGAGTGACCAAGT'],
         15)
  print(f"k={input[1]}-motif search on {input[0]}")
  soln = randomized_motif_search(*input, iterations=5) #, debug=True)

  profiler.disable()
  profiler.print_stats(sort='time')

  print(soln)
  print_iter(soln[0])

if __name__ == '__main__':
  sys.exit(pytest.main(["-s", "week4.py::test_week4"])) #-s to not suppress prints
