import sys
import pytest
import math

from lib import *
from util import *
import constants

import cProfile

def test_week4():
  print_sep("Randomized Motif Search")
  
  profiler = cProfile.Profile()
  profiler.enable()
  input=(['GAAATGGACCTTTGTAAGCTCCCTTCAAAGTGGTTCAATTTTAAGCCCACGAAACCCCTCCCTTATGTCTAGATAACGTCAACGCCTGGAAACGCAACGCGTTCGCACACAGCCGTGCCCTGGCGCTTGGATCGGCCCCTTATGAGAGATGGAAGAAATGGACCTTTGT','AAGCTCCCTTCAAAGTGGTTCAATTTTAAGCCCACGAAGTCCCATATTTTTGCACCCCTCCCTTATGTCTAGATAACGTCAACGCCTGGAAACGCAACGCGTTCGCACACAGCCGTGCCCTGGCGCTTGGATCGGCCCCTTATGAGAGATGGAAGAAATGGACCTTTGT','ACTGTTGCATGTATTTTTGACAGGGTATTGAGTGGTTAGCAAGGATCCTCGAAAACGCCCACTCTCCAAGGGAATAATCAAGCAATCAGTTGCACATCAGTACAGTCGATAGGTTGTATTCCCTCGTAGAGATTGTGGTAAGTCGCGAGTGATAAGTTATGCTTTCAAC','CAAGGGCGTGGTCTTGTTCAGGTATCACGTATTGACGGATGGAATGTGTACTTACTGCTGCTCGGAAGCTTTCGGCGATAAAGAACGTTGATTCCAGGCGCTCTCGTCGAGTCATGTATCACTGCTGCAAATACGTGGTCCACTATGTCTTTGCAATTCGACGGACTAA','CGAGCTGGATGCCCATAATCGGTCATGTATTCCCGCTGCACGCCGGTGGAGCTTATCCGAACACGGACTCTGCGCCGGGCGTCCCATCAGCATAGAAACTCTCATCATGTAATGACGCGCGAACCTTATCGGTTCGCGTCTAACATGGTGCTGCCTTGCTGTTGTACTG','AAATGATGGTCAGTCACCATGCATGGACCTCATGTATTTTTATAGGCGGACTCAGACTATCCTACGAAAGTGAGGGCCCGGTACGCAGACAGAACGCGCGAGGCGACCGCGTCCCGCGATGGAAAGGGGATGCCGCCGGCCAACTTTCAGTCTGCTGAGTCTACGATTG','ACCCCTGCTCGCGTTTTCCTTTACAGCCGAGTGGTCAGTACGCCTACACCAGTCCCGTTCGGTATCCAGCAAGCCAACCATTTGGAGGGCTGTGGGCAAACGTCATGATATTTTGCCGGACAATTCACCTACGTAAGATAAACAATGGCCGGGTACTCTCCGCTTTCGG','TTCTACAGGAGGTTCACGAAGGGCCGCAGAATTACCTCCAAGCTCATCAAGACGGGGCGAAAACCGTGGACTTTATAATGGAGGAGACATACACCCGTGGCCAACAGAAGCTATACGGGTCCCACTTGATCGCGTTGACTCGGGGGTCATGTTGATTTGCCCCCATCTC','TAAAAATTAGGCTCAAGCATGTAGGACTGAAAGCATTTCCAGCATTCGTTCCTCTCACTCCCTCCACGAGGGGGGATCGCGATCTAGTACCTTCACCACCAAGGGGACTGGTCATGTATTTGCCCGGTCGCTATCCCCTAGGCCCATGCCGGACATTTACAAGCCAACG','TTATTCCACGTGATTTGAGTTCTAACCACCCGCGCCTTCGTATCGCCACGAGGGTTGTATTTTTGCCAGATGATCCCTTAACCGTGGGCAAAATAGAACCCTGAGGATAGACACGGGTTTGGGCGCCTCCCAGAGGTGCTACTCACGCGAGGTTTAACAAGCATCAGTA','TGAAACTTACCAAAGTTCGCCTTGCCTGTCCCGGCCCGCAGCCCTCTGGATCTGGACGGGAGAAAGGCAGTTGCGGGTGACACAAGCTGGAAAAGAACGGTAGTACAAGTTTTAGGGTAGCGGTGCTACGGATCACCCACTAAATATGTATTTTTGCAGGCGACTAGAC','CTAGGGATCGTCCAGTCCAAAAAATGATCGCCGATGGTCAACCATTTTTGCCATCTGATAGAGAGTTTCATCTTATGCAGCTAATCACTACCGCGCTGTTCTTGGGGCCTGAACCGCCTACGTGGGTGGACCTGATTATTCTGCCCGGCTCAACTATCGTTGCTCCAAT','TCCGATGAACGGCAAGGGAGGTGCCAAGACATACGGTTAGACGCTCCCTATGTCATGTATTTTCATATCAGGCGGAGGTCCGTGTCTACCAGCTCGGGTCACCTAGGGGGATAGCGTTGTATAGGATCGCTTGTGTGGTCGCACTGAAGCGGAAAAATTAGGGGCCGTC','ACCGATATACACCCCTGCCTCCTTGTCGTCTTGGTCAGTGAATTGTGCGCCGCGTGTGGCACCTAGTTAACACGAAGCAACTAACTATCGCCGATGTTTGCCCCCAATCGCTTCTAGCTACCCACGTCATGTAAGCTTGCCGTTATGTCCCCGTCAGGCCCGGGTAGTA','AAACATCAAACAGTAAAATATAGTTTCCGTTATAGTCTACCCGGTAGTAGCGTATTTTTGCGATACAGAAGTCCGAGAGCAAGGATTAGTTATGCGTGGGAAAGCACCTGGTGCTTTATCCCTTACACTGCGACGATTTAAGGCCTCTGTGTATATACTCGACTTACAA','AGCTAGTCCCTTATTTTTGCCGATCGAAATAGTGGCATTTGTTGGTTCGAGGGAACGTATGACCGATTGTTGAGTGACCCGATTTATGGGCCGTACCAACTTGCGCGCATACTCCATACTCTACACACACGTTTTACCGAGAGAACTTGAAGCCAATGCGACCTAAACA','CCAAGAGGCTATTAGCGGCACAGGGTGCGTGCCTCGTGATTTCGGAGTGCTTTAGTCCCAAAAAGGAAGCGGCTGAGGTGACTGCGCTTCCTAAGTTTCAACGCGGTGGGTGCGCGCGAAGTCACTAATTTTTGCCGTGGCGGTCTAATAGACAAGCTGGGGTGTGTCG','GGCCGTCGTACATTTGATCTCGGCGGGCCCTCACAGCAGGGTCCTCTGCGTGCACCCCGCATATGAGGACCCCCTAAATTTGTACATGAGTGAGGGTCATAGCTTTTTGCTTACCCCACAACGTAAGTATGATTGATGAGATTCTAGTGCGGGGCTAGTTAATTGTACA','CGCACCAGCCTTGTTCGCTCATCCCGTCATGACATTTTGCTTGTTTGAACCCCTTTTACAGATCAGATACGGCTTAATTTACGACACACAGGCAGTAGATACGCTGGTGGGTGTACAATAAAAAGCACCTTGTACTCAGCCATCGCCGGGCCGCACGATGAAGGTGGCG','ACGCCAAGTGGCTGTGTGGCCGCACGAAGTTTTCATGGACCGAAGCCCAACTACGTCATCAGTTTTTGCAGTGTGCAGCCTTTCGTCCCACGGATCGGTGGTCTAAAGTCGACCTATGCGAGGACGCTTGGTAACATTCGAGCTCTTACCCCTTATAGTCATATGTCCG'],
         15)
  print(f"k={input[1]}-motif search on {input[0]}")
  soln = randomized_motif_search(*input, iterations=1000, debug=False) #takes about 1.5s/10 iters

  profiler.disable()
  profiler.print_stats(sort='time')
  profiler.stats


  print(soln)
  print_iter(soln[0])

if __name__ == '__main__':
  sys.exit(pytest.main(["-s", "week4.py::test_week4"])) #-s to not suppress prints
